<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Parkour Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  background: #111;
  touch-action: none;
}

canvas {
  display: block;
  background: linear-gradient(#6ec6ff, #b3e5fc);
}

/* Mobile Controls */
#controls {
  position: fixed;
  bottom: 12px;
  width: 100%;
  display: flex;
  justify-content: space-between;
  padding: 0 15px;
  box-sizing: border-box;
}

.group {
  display: flex;
  gap: 12px;
}

.btn {
  width: 64px;
  height: 64px;
  border-radius: 50%;
  font-size: 26px;
  border: none;
  background: rgba(0,0,0,0.7);
  color: white;
}
</style>
</head>
<body>

<canvas id="game"></canvas>

<div id="controls">
  <div class="group">
    <button class="btn" id="left">←</button>
    <button class="btn" id="right">→</button>
  </div>
  <div class="group">
    <button class="btn" id="jump">⤒</button>
  </div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
resize();
addEventListener("resize", resize);

/* ================= CAMERA ================= */
let camX = 0;

/* ================= PLAYER IMAGE ================= */
let imgLoaded = false;
const playerImg = new Image();
playerImg.src = "mango.png"; // ← CHANGE THIS IF USING A LINK
playerImg.onload = () => imgLoaded = true;

/* ================= PLAYER ================= */
const player = {
  x: 100,
  y: 0,
  w: 48,
  h: 48,
  dx: 0,
  dy: 0,
  onGround: false
};

let facing = 1; // 1 = right, -1 = left

/* ================= PHYSICS ================= */
const gravity = 0.9;
const speed = 1.6;
const friction = 0.85;
const jumpPower = 16;

/* ================= LEVEL ================= */
const platforms = [];

// Ground
platforms.push({ x: -2000, y: 450, w: 12000, h: 40 });

// Floating platforms
for (let i = 0; i < 20; i++) {
  platforms.push({
    x: i * 260,
    y: 380 - (i % 4) * 60,
    w: 160,
    h: 20
  });
}

/* ================= INPUT ================= */
const input = { left:false, right:false, jump:false };

// Keyboard
addEventListener("keydown", e => {
  if (e.key === "a" || e.key === "ArrowLeft") input.left = true;
  if (e.key === "d" || e.key === "ArrowRight") input.right = true;
  if (e.key === "w" || e.key === "ArrowUp" || e.key === " ") input.jump = true;
});

addEventListener("keyup", e => {
  if (e.key === "a" || e.key === "ArrowLeft") input.left = false;
  if (e.key === "d" || e.key === "ArrowRight") input.right = false;
  if (e.key === "w" || e.key === "ArrowUp" || e.key === " ") input.jump = false;
});

// Mobile buttons
left.onpointerdown = e => { e.preventDefault(); input.left = true; };
left.onpointerup = () => input.left = false;

right.onpointerdown = e => { e.preventDefault(); input.right = true; };
right.onpointerup = () => input.right = false;

jump.onpointerdown = e => {
  e.preventDefault();
  if (player.onGround) {
    player.dy = -jumpPower;
    player.onGround = false;
  }
};

/* ================= UPDATE ================= */
function update() {
  if (input.left) {
    player.dx -= speed;
    facing = -1;
  }
  if (input.right) {
    player.dx += speed;
    facing = 1;
  }

  if (input.jump && player.onGround) {
    player.dy = -jumpPower;
    player.onGround = false;
  }

  player.dy += gravity;
  player.dx *= friction;

  player.x += player.dx;
  player.y += player.dy;

  player.onGround = false;

  platforms.forEach(p => {
    if (
      player.x < p.x + p.w &&
      player.x + player.w > p.x &&
      player.y + player.h <= p.y + 6 &&
      player.y + player.h + player.dy >= p.y
    ) {
      player.y = p.y - player.h;
      player.dy = 0;
      player.onGround = true;
    }
  });

  // Respawn
  if (player.y > 1000) {
    player.x = 100;
    player.y = 0;
    player.dx = player.dy = 0;
  }

  // Camera follow (smooth)
  const targetCamX = player.x - canvas.width / 2 + player.w / 2;
  camX += (targetCamX - camX) * 0.1;
}

/* ================= DRAW ================= */
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  ctx.save();
  ctx.translate(-camX, 0);

  // Platforms
  ctx.fillStyle = "#333";
  platforms.forEach(p => ctx.fillRect(p.x, p.y, p.w, p.h));

  // Player (flipped)
  ctx.save();
  ctx.translate(
    player.x + player.w / 2,
    player.y + player.h / 2
  );
  ctx.scale(facing, 1);

  if (imgLoaded) {
    ctx.drawImage(
      playerImg,
      -player.w / 2,
      -player.h / 2,
      player.w,
      player.h
    );
  } else {
    ctx.fillStyle = "red";
    ctx.fillRect(
      -player.w / 2,
      -player.h / 2,
      player.w,
      player.h
    );
  }

  ctx.restore();
  ctx.restore();
}

/* ================= LOOP ================= */
function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>

